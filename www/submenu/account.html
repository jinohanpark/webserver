
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>IP CAMERA</title>

<link rel="stylesheet" href="/include/jquery/jquery-ui.css">
<script src="/include/jquery/jquery.js"></script>
<script src="/include/jquery/jquery-ui.js"></script>

<link rel="stylesheet" href="/default.css">
<script src="/socket.io/socket.io.js"></script>
<script src="/submenu_nav.js"></script>
<script src="/include/aes.js"></script>

<style>
	div#users-list { width: 100%; height: 170px; }
	div#users-list table { margin-top: 0.8em; margin-bottom: 1em; border-collapse: collapse; width: 98.5%; }
	div#users-list table th { background: #999999; }
	div#users-list table td { background: #dedede; }
	div#users-list table th,
	div#users-list table td { padding-left: 1em; padding-top: 0.2em; padding-bottom: 0.2em; border: 1px solid #bebebe; text-align: left; }

	.table-tr-hover { background: #C0DDEC !important; }
	.table-tr-selected { background: #58BCF1 !important; color:#ffffff; }
	.table-tr-offscreen { position: absolute; left: -10000px; }

	div#table-pagenav { text-align: left; margin-bottom: 10px; }
	div#table-pagenav a { padding: 3px; color: #1759A3; text-decoration: none; margin: 0 0.5em; }
	.table-pagenav-selected { background: #1759A3; color: #ffffff !important; font-weight: bold; cursor: default; }

	#dialog-link-add, #dialog-link-modify, #dialog-link-remove {
		padding: .4em .8em .2em 30px;
		text-decoration: none;
		position: relative;
	}
	#dialog-link-add span.ui-icon,
	#dialog-link-modify span.ui-icon,
	#dialog-link-remove span.ui-icon
	{
		margin: 0 5px 0 0;
		position: absolute;
		left: .2em;
		top: 50%;
		margin-top: -8px;
	}

	.ui-dialog .ui-state-error { padding: .3em; }
	.validateTips { border: 1px solid transparent; padding: 0.3em; }

	label, input { display:block; }
	input .text { margin-bottom:12px; width:95%; padding: .4em; }
	fieldset { padding:0; border:0; margin-top:25px; }

</style>

<script src="configuration.ssi?action=query&lvalue=account.%&var=gserverform_account"></script>

<script>
	Init_jQuery();


</script>
</head>

<body>
<table id="wrap" class="layout_grid" align=center>
<thead>
	<tr>
		<td>
		thead
		</td>
	</tr>
</thead>

<tbody>
	<tr>
		<td>
		<table id="wrap_body" class="layout_grid" width="100%">
		<tr>
			<td id="wrap_body_leftnav" class="left_nav">
				<script>showSubmenu('submenu_nav');</script>
			</td>

			<td id="wrap_body_contents">
				<!-- body/title -->
				<table id="contents_title" class="layout_grid">
				<thead>
					<tr>
						<td>
						<div>
							<h3>
								<script>getSubmenuText();</script>
							</h3>
						</div>
						</td>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>
						<div>
							<p>
								사용자 계정 추가, 삭제, 수정한다. 웹서버 및 스트림서버를 포함한 시스템에 접근할 수 있는 권한을 설정한다.
							</p>
						</div>
						</td>
					</tr>
				</tbody>	
				</table id="contents_title">

				<!-- body/contents -->
				<table id="contents_body1">
				<thead>
					<tr>
						<th data-widthpercolumn="'35%','25%','0%'">
							User List
						</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td colspan="3">
							<div id="users-list">
								<table id="users">
						   		<thead>
						   			<tr>
						   				<th width="25%">이름NAMEname</th>
						   				<th width="45%">권한 그룹</th>
						   				<th width="25%">정보</th>
						   			</tr>
						   		</thead>
						   		<tbody>
						   			<tr>
						   				<td>John Doe</td><td>john.doe@example.com</td><td>johndoe1</td>
						   			</tr>
						   			<tr>
						   				<td>John Doe</td><td>john.doe@example.com</td><td>johndoe1</td>
						   			</tr>
						   			<tr>
						   				<td>테스터1</td><td>tester1@example.com</td><td>test1</td>
						   			</tr>
						   			<tr>
						   				<td>John Doe</td><td>john.doe@example.com</td><td>johndoe1</td>
						   			</tr>
						   			<tr>
						   				<td>John Doe</td><td>john.doe@example.com</td><td>johndoe1</td>
						   			</tr>
						   			<tr>
						   				<td>테스터1</td><td>tester1@example.com</td><td>test1</td>
						   			</tr>
						   			<tr>
						   				<td>John Doe</td><td>john.doe@example.com</td><td>johndoe1</td>
						   			</tr>
						   			<tr>
						   				<td>John Doe</td><td>john.doe@example.com</td><td>johndoe1</td>
						   			</tr>
						   			<tr>
						   				<td>가John Doe</td><td>나john.doe@example.com</td><td>다johndoe1</td>
						   			</tr>
						   		</tbody>
								<tfoot></tfoot>
								</table>
							</div>
						</td>
					</tr>
					<tr>
						<td colspan="3">
							<p>
							<a href="#add" id="dialog-link-add" class="ui-state-default ui-corner-all">
								<span class="ui-icon ui-icon-newwin"></span>
								추가
							</a>
							&nbsp;
							<a href="#modify" id="dialog-link-modify" class="ui-state-default ui-corner-all">
								<span class="ui-icon ui-icon-newwin"></span>
								수정
							</a>
							&nbsp;
							<a href="#remove" id="dialog-link-remove" class="ui-state-default ui-corner-all">
								삭제
							</a>
							</p>
						</td>
					</tr>
					<tr>
						<td>
							Data List tables... IPv4 address setting
							<dt>데이터 리스트1-1</dt>
								<dd>데이터1</dd>
								<dd>데이터2</dd>
						</td>
						<td>
							<dt><br></dt>
							<dt><br></dt>
							<dt>데이터 리스트1-1</dt>
							<dt>데이터 리스트1-2</dt>
						</td>
					</tr>
					<tr>
						<td>bbb1</td>
						<td>bbb2</td>
						<td>bbb3</td>
					</tr>
					<tr>
						<td><dl><dt>
							데이터 타이틀
								<dd>데이터1</dd>
								<dd>데이터2</dd>
						</dt></dl></td>
						<td>
						</td>
					</tr>
				</tbody>
				<tfoot></tfoot>
				</table id="contents_body1">

				<!-- body/contents -->
				<table id="contents_body2">
				<thead>	
					<tr>
						<th data-widthpercolumn="'35%','55%'">
							인증 방법
						</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>
							간단한 기본 인증 방식
						</td>
					</tr>
					<tr>
						<td>
							암호화 된 패킷을 통한 인증 방식
						</td>
					</tr>
					<tr>
						<td>
							인증 과정 없음
						</td>
					</tr>
				</tbody>	
				<tfoot></tfoot>
				</table id="contents_body2">

				<!-- body/contents -->
				<table id="contents_body3">
				<thead>
					<tr>
						<th data-widthpercolumn="'35%','55%'">
							기타 설정
						</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>
							인증 과정 없이 영상을 볼 수 있다.
						</td>
						<td>
							진짜???
						</td>
					</tr>
					<tr>
						<td>
							인증 과정 없이 PTZ 제어를 할 수 있다.
						</td>
						<td>
							정말???
						</td>
					</tr>
				</tbody>
				<tfoot></tfoot>
				</table id="contents_body3">
			</td id="wrap_body_contents">
		</tr>
		</table id="wrap_body">
		</td>
	</tr>
	
	<tr>
		<td>
		xxxxxxx
		</td>
	</tr>
</tbody>

<tfoot>
	<tr>
		<td>
		tfoot
		</td>
	</tr>
</tfoot>

</table id="wrap">

<!--****************************************************************-->
<div id='dialog-form' title='' data-action=''>
	<p id='dialog-caption'></p>
	<p class='validateTips'></p>
	<form>
	<fieldset>
		<label for="name">이름</label>
		<input type="text" name="name" id="name" value="" class="text ui-widget-content ui-corner-all" />
		<label for="email">이메일</label>
		<input type="text" name="email" id="email" value="" class="text ui-widget-content ui-corner-all" />
		<label for="password">열쇠글</label>
		<input type="password" name="password" id="password" value="" class="text ui-widget-content ui-corner-all" />
	</fieldset>
	</form>
</div>

</body>
</html>

<script>
	//
	function init_appearance() {
		_init_all_table();

		_init_body_table('table#contents_body1');
		_init_body_table('table#contents_body2');
		_init_body_table('table#contents_body3');

		_init_userslist_table('div#users-list');

		_init_dialogopen_button('#dialog-link-add');
		_init_dialogopen_button('#dialog-link-modify');
		_init_dialogopen_button('#dialog-link-remove');

		_init_dialogbox();

		function _init_dialogbox() {
			jQuery('#dialog-form').attr('title', '사용자 계정 관리');
			jQuery('#dialog-form').dialog( {
				autoOpen: false,
				width: 450,
				height: 400,				
				modal: true,
				buttons: [],
				//event...
				create: function( _event, _ui ) {
					;
				},
				open: function( _event, _ui ) {
					var action = $(this).attr('data-action');
					if( '#add' == action ) { $('#dialog-caption').text('새로운 사용자 추가'); }
					else
					if( '#modify' == action ) { $('#dialog-caption').text('기존 사용자 수정'); }
				},
				close: function() {
					var allFields = $([]).add('#name').add( '#email' ).add( '#password' );
					allFields.val( "" ).removeClass( "ui-state-error" );
				}
			});
		}

		function ondialog_closeclick() {
			var	allFields = $([]).add('#name').add( '#email' ).add( '#password' );
			var	tips = $( ".validateTips" );

			tips.text("");
			allFields.val( "" ).removeClass( "ui-state-error" );
			$( this ).dialog( "close" );
		}

		function ondialog_actionclick() {
			var name = $( "#name" ),
				email = $( "#email" ),
				password = $( "#password" );
			var	allFields = $([]).add(name).add(email).add(password);

			var bValid = true;
			allFields.removeClass( "ui-state-error" );

			function updateTips( t ) {
				var tips = $( ".validateTips" );

				tips.text(t).addClass( "ui-state-highlight" );
				setTimeout( function() {
					tips.removeClass( "ui-state-highlight", 2500 );
				}, 500 );
			}

			function checkLength( o, n, min, max ) {
				if( o.val().length > max || o.val().length < min ) {
					o.addClass( "ui-state-error" );
					updateTips( "Length of " + n + " must be between " + min + " and " + max + "." );
					return false;
				}
				else {
					return true;
				}
			}

			function checkRegexp( o, regexp, n ) {
				if ( !( regexp.test( o.val() ) ) ) {
					o.addClass( "ui-state-error" );
					updateTips( n );
					return false;
				} else {
					return true;
				}
			}

			bValid = bValid && checkLength( name, "username", 3, 16 );
			bValid = bValid && checkLength( email, "email", 6, 80 );
			bValid = bValid && checkLength( password, "password", 5, 16 );

			bValid = bValid && checkRegexp( name, /^[a-z]([0-9a-z_])+$/i, "Username may consist of a-z, 0-9, underscores, begin with a letter." );
			// From jquery.validate.js (by joern), contributed by Scott Gonzalez: http://projects.scottsplayground.com/email_address_validation/
			bValid = bValid && checkRegexp( email, /^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i, "eg. ui@jquery.com" );
			bValid = bValid && checkRegexp( password, /^([0-9a-zA-Z])+$/, "Password field only allow : a-z 0-9" );

			if ( bValid ) {
				$( "#users tbody" ).append( "<tr>" +
					"<td>" + name.val() + "</td>" + 
					"<td>" + email.val() + "</td>" + 
					"<td>" + password.val() + "</td>" +
				"</tr>" );

				_init_userslist_table('div#users-list');
				$( this ).dialog( "close" );
			}
		}

		function _init_dialogopen_button(_szselector) {
			jQuery(_szselector)
			.hover( function() {
				$(this).toggleClass('ui-state-hover');
			})
			.click( function(_event) {
				_event.preventDefault();

				var action = $(this).attr('href');
				if( '#remove' == action ) {
					;
				}
				else {
					if( '#add' == action ) {
						$( "#dialog-form" ).dialog( "option", "buttons",
							[{text:'추가', click:ondialog_actionclick},
						 	 {text:"닫기", click: ondialog_closeclick}] );
					}
					else {
						$( "#dialog-form" ).dialog( "option", "buttons",
							[{text:'수정', click:ondialog_actionclick},
						 	 {text:"닫기", click: ondialog_closeclick}] );
					}
					$( "#dialog-form" ).attr( 'data-action', action ).dialog( "open" );
				}
			});
		}

		function _init_userslist_table(_szselector) {
			////////////////////////
			jQuery(_szselector + ' table tbody tr')
			.hover( 
				function() { $(this).children('td').addClass('table-tr-hover'); },
				function() { $(this).children('td').removeClass('table-tr-hover'); }
			)
			.click( function(_event) {
				_event.preventDefault();
				$(this).parent().find('tr td').removeClass('table-tr-selected');
				$(this).children('td').addClass('table-tr-selected');
			});

			////////////////////////
			jQuery('div#table-pagenav').remove();
			jQuery(_szselector).after('<div id="table-pagenav"></div>');

			//
			var jtr = jQuery(_szselector + ' table tbody tr');
			var nrowperpage = 6;
			var nrowtotal = jtr.length;
			var npagestotal = Math.ceil(nrowtotal/nrowperpage);
			var i;

			for(i = 0; i < npagestotal; i++) {
				jQuery('<a href="#"></a>').attr('rel', i).html(i+1).appendTo('#table-pagenav');
			}
			//jtr.addClass('table-tr-offscreen')
			//   .slice(0, nrowperpage)
			//   .removeClass('table-tr-offscreen');

			//
			jQuery('#table-pagenav a').click( function(_event) {
				_event.preventDefault();
				if( $(this).hasClass('table-pagenav-selected') ) { return; }
				$('#table-pagenav a').removeClass('table-pagenav-selected');
				$(this).addClass('table-pagenav-selected');

				var currpage = $(this).attr('rel');
				var startitem = currpage * nrowperpage;
				var enditem = startitem + nrowperpage;

				jtr.css('opacity', '0.0')
				   .addClass('table-tr-offscreen')
				   .slice(startitem, enditem)
				   .removeClass('table-tr-offscreen')
				   .animate({opacity:1}, 300);
			});

			if( !jQuery('#table-pagenav a').hasClass('table-pagenav-selected') ) {
				jQuery('#table-pagenav a:eq(0)').click();
				//jQuery('#table-pagenav a:first').addClass('table-pagenav-selected');
			}
		}

		function _init_all_table() {
			//
			jQuery('table').attr('cellspacing', '0').attr('cellpadding', '2');

			//
			jQuery('#wrap_body_contents > table').before('<dt>').after('<br></dt>');
		}

		function _init_body_table(_szselector) {
			// for debugging
			//jQuery(_szselector).attr('border', '1');

			//
			jQuery(_szselector).attr('class', 'ui-widget ui-widget-content ui-corner-top');
			jQuery(_szselector + ' thead tr').attr('class', 'ui-widget-header');

			//
			jQuery(_szselector).attr('width', '100%');
			var szcolwidths = jQuery(_szselector + ' thead tr:first th').attr('data-widthpercolumn') || '';
			var acolwidths = eval('['+ szcolwidths  +']');
			var ncols = acolwidths.length;

			jQuery(_szselector + ' thead tr:first th').attr('colspan', ncols)
													  .attr('align', 'left')
													  .css('padding-left', '1em');

			jQuery(_szselector + ' tbody > tr').each( function() {
				var i = 0;
				var colspan = 0;
				$(this).children('td').each( function() {
					$(this).attr('width', acolwidths[i++]).attr('cellspacing', '5');
					colspan += $(this).attr('colspan') || 0;
				});
				//console.log('i=%d, ncols=%d, colspan=%d', i, ncols, colspan);
				colspan = (0 != colspan) ? colspan-1 : colspan;
				for( ; i<(ncols-colspan); i++ ) $(this).append('<td></td>');
			})
			.find('td:first').css('padding-left', '1em');

			jQuery(_szselector + ' tbody:first tr:odd').css('background', '#e5e5e5');
			//jQuery(_szselector + ' tbody:first tr:even').css('background', '#ffffff');
		}
	}

	jQuery(document).ready( function() {
		//
		init_appearance();

/*	
		jQuery('table tr:even').css('background', '#dedede');
		jQuery('table tr:odd').css('background', '#ffffff');
		
		init_appearance();

		//
		$(function() {
			console.log('gserverform_account', gserverform_account['account.enable'][1]);
		});
		


		//		var socket = io.connect();
		ocket.on( '_mymsgack', function(_data) {
			alert(_data);
		});

		$('#idbutton').bind('click', function() {
		
		//document.getElementById('idbutton').onclick = function() {
		//var text = document.getElementById('idtext').value;
			//socket.emit('_mymsg', text);
			socket.emit('_mymsg', $('#idtext').val());
		});

		$('#idtext').bind('keypress', function(_event) {
			//console.log('keycode :'+_event.which);
			if( 13 == _event.which ) {
				_event.preventDefault();
				$('#idbutton').click();
			}
		});
});
*/		
	});
</script>
